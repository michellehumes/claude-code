name: Run Gmail Labels and Filters Script

on:
  schedule:
      - cron: '0 6 * * *'
        workflow_dispatch:

        jobs:
          run-gmail-script:
              runs-on: ubuntu-latest
                  steps:
                        - name: Checkout repository
                                uses: actions/checkout@v4

                                      - name: Set up Python
                                              uses: actions/setup-python@v5
                                                      with:
                                                                python-version: '3.11'

                                                                      - name: Install dependencies
                                                                              run: |
                                                                                        python -m pip install --upgrade pip
                                                                                                  pip install google-api-python-client google-auth-httplib2 google-auth-oauthlib

                                                                                                        - name: Run Gmail script
                                                                                                                env:
                                                                                                                          GOOGLE_CREDENTIALS: ${{ secrets.GOOGLE_CREDENTIALS }}
                                                                                                                                    GOOGLE_TOKEN: ${{ secrets.GOOGLE_TOKEN }}
                                                                                                                                            run: |
                                                                                                                                                      echo "$GOOGLE_CREDENTIALS" > credentials.json
                                                                                                                                                                if [ -n "$GOOGLE_TOKEN" ]; then
                                                                                                                                                                            echo "$GOOGLE_TOKEN" > token.pickle
                                                                                                                                                                                      fi
                                                                                                                                                                                                python gmail_labels_filters.py
